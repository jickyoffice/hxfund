# ğŸš€ é»„æ°å®¶æ—å¯»æ ¹å¹³å° - éƒ¨ç½²ç»“æ„è¯´æ˜

## ğŸ“Š éƒ¨ç½²æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ç”¨æˆ·è®¿é—®                                  â”‚
â”‚                           â†“                                     â”‚
â”‚                   https://hxfund.cn                             â”‚
â”‚                           â†“                                     â”‚
â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚
â”‚          â”‚  é˜¿é‡Œäº‘è™šæ‹Ÿä¸»æœº (å‰ç«¯)    â”‚                           â”‚
â”‚          â”‚  20GB å­˜å‚¨ / 1G æµé‡        â”‚                           â”‚
â”‚          â”‚  dist/ é™æ€èµ„æº           â”‚                           â”‚
â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚
â”‚                           â†“ API è°ƒç”¨                             â”‚
â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚
â”‚          â”‚  é˜¿é‡Œäº‘ ECS (åç«¯)        â”‚                           â”‚
â”‚          â”‚  2 æ ¸ 2GiB                 â”‚                           â”‚
â”‚          â”‚  Node.js + Express        â”‚                           â”‚
â”‚          â”‚  PM2 è¿›ç¨‹ç®¡ç†             â”‚                           â”‚
â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ å®Œæ•´é¡¹ç›®ç»“æ„

```
qwen3.5/
â”‚
â”œâ”€â”€ ğŸ“‚ deploy/                 â† ğŸ“‹ éƒ¨ç½²é…ç½®ï¼ˆæ–°å¢ï¼‰
â”‚   â”œâ”€â”€ é˜¿é‡Œäº‘éƒ¨ç½²æŒ‡å—.md       â† è¯¦ç»†éƒ¨ç½²æ–‡æ¡£
â”‚   â”œâ”€â”€ å‰ç«¯éƒ¨ç½²é…ç½®.md         â† å‰ç«¯éƒ¨ç½²è¯´æ˜
â”‚   â”œâ”€â”€ ecs-deploy.sh          â† ECS ä¸€é”®éƒ¨ç½²è„šæœ¬
â”‚   â””â”€â”€ é¡¹ç›®éƒ¨ç½²ç»“æ„è¯´æ˜.md     â† æœ¬æ–‡ä»¶
â”‚
â”œâ”€â”€ ğŸ“‚ scripts/                â† ğŸ› ï¸ è„šæœ¬å·¥å…·
â”‚   â”œâ”€â”€ build.js               â† æ„å»ºè„šæœ¬
â”‚   â”œâ”€â”€ qwen-code.js           â† Qwen AI CLI
â”‚   â””â”€â”€ qwen-code.bat          â† Windows å¿«æ·æ–¹å¼
â”‚
â”œâ”€â”€ ğŸ“‚ tests/                  â† ğŸ§ª æµ‹è¯•è„šæœ¬
â”‚   â”œâ”€â”€ test-api.js            â† API æ¥å£æµ‹è¯•
â”‚   â”œâ”€â”€ test-auth.js           â† è®¤è¯ç³»ç»Ÿæµ‹è¯•
â”‚   â””â”€â”€ test-chat.js           â† AI å¯¹è¯æµ‹è¯•
â”‚
â”œâ”€â”€ ğŸ“‚ docs/                   â† ğŸ“– é¡¹ç›®æ–‡æ¡£
â”‚   â”œâ”€â”€ DEPLOYMENT.md          â† éƒ¨ç½²æŒ‡å—
â”‚   â”œâ”€â”€ OPTIMIZATION_REPORT.md â† ä¼˜åŒ–æŠ¥å‘Š v1
â”‚   â”œâ”€â”€ OPTIMIZATION_REPORT_V2.md â† ä¼˜åŒ–æŠ¥å‘Š v2
â”‚   â”œâ”€â”€ QWEN_SETUP.md          â† Qwen é…ç½®æŒ‡å—
â”‚   â””â”€â”€ ç›®å½•ç»“æ„è¯´æ˜.md        â† ç›®å½•è¯´æ˜
â”‚
â”œâ”€â”€ ğŸ“‚ public/                 â† ğŸ¨ å‰ç«¯æºç 
â”‚   â”œâ”€â”€ css/
â”‚   â”‚   â””â”€â”€ style.css          â† ä¸»æ ·å¼è¡¨
â”‚   â”œâ”€â”€ js/
â”‚   â”‚   â”œâ”€â”€ data.js            â† æ•°æ®æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ main.js            â† ä¸»é€»è¾‘
â”‚   â”‚   â”œâ”€â”€ modules.js         â† åŠŸèƒ½æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ script.js          â† AI å®¢æˆ·ç«¯
â”‚   â”‚   â””â”€â”€ error-monitor.js   â† é”™è¯¯ç›‘æ§
â”‚   â”œâ”€â”€ pwa/
â”‚   â”‚   â”œâ”€â”€ manifest.json      â† PWA æ¸…å•
â”‚   â”‚   â””â”€â”€ service-worker.js  â† Service Worker
â”‚   â”œâ”€â”€ tests/                 â† æµ‹è¯•é¡µé¢
â”‚   â””â”€â”€ README.md              â† å‰ç«¯ç›®å½•è¯´æ˜
â”‚
â”œâ”€â”€ ğŸ“‚ server/                 â† âš™ï¸ åç«¯æœåŠ¡
â”‚   â”œâ”€â”€ index.js               â† Express æœåŠ¡å™¨
â”‚   â”œâ”€â”€ auth.js                â† è®¤è¯æ¨¡å—
â”‚   â”œâ”€â”€ cli-wrapper.js         â† AI CLI å°è£…
â”‚   â”œâ”€â”€ session-store.js       â† Redis ä¼šè¯å­˜å‚¨
â”‚   â””â”€â”€ config/
â”‚       â”œâ”€â”€ .env               â† ç¯å¢ƒå˜é‡
â”‚       â””â”€â”€ auth.json          â† è®¤è¯é…ç½®ï¼ˆæ•æ„Ÿï¼‰
â”‚
â”œâ”€â”€ ğŸ“‚ dist/                   â† ğŸ“¦ æ„å»ºè¾“å‡ºï¼ˆéƒ¨ç½²ç”¨ï¼‰
â”‚   â”œâ”€â”€ index.html             â† ä¸»é¡µé¢ï¼ˆå« API é…ç½®ï¼‰
â”‚   â”œâ”€â”€ css/
â”‚   â”‚   â””â”€â”€ style.min.css      â† å‹ç¼©æ ·å¼
â”‚   â”œâ”€â”€ js/
â”‚   â”‚   â”œâ”€â”€ data.min.js        â† å‹ç¼©æ•°æ®æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ main.min.js        â† å‹ç¼©ä¸»é€»è¾‘
â”‚   â”‚   â”œâ”€â”€ modules.min.js     â† å‹ç¼©åŠŸèƒ½æ¨¡å—
â”‚   â”‚   â””â”€â”€ script.min.js      â† å‹ç¼© AI å®¢æˆ·ç«¯
â”‚   â””â”€â”€ pwa/
â”‚       â”œâ”€â”€ manifest.json
â”‚       â””â”€â”€ service-worker.js
â”‚
â”œâ”€â”€ ğŸ“‚ .github/                â† GitHub é…ç½®
â”œâ”€â”€ index.html                 â† å¼€å‘ç”¨ä¸»é¡µé¢
â”œâ”€â”€ package.json               â† é¡¹ç›®é…ç½®
â”œâ”€â”€ .gitignore                 â† Git å¿½ç•¥é…ç½®
â”œâ”€â”€ LICENSE                    â† MIT è®¸å¯è¯
â”œâ”€â”€ vercel.json                â† Vercel éƒ¨ç½²é…ç½®
â””â”€â”€ netlify.toml               â† Netlify éƒ¨ç½²é…ç½®
```

---

## ğŸ¯ éƒ¨ç½²æ–‡ä»¶å¯¹åº”å…³ç³»

### å‰ç«¯ï¼ˆè™šæ‹Ÿä¸»æœºï¼‰

| æºç  | æ„å»ºè¾“å‡º | éƒ¨ç½²ä½ç½® |
|------|----------|----------|
| `public/css/style.css` | `dist/css/style.min.css` | `htdocs/css/style.min.css` |
| `public/js/data.js` | `dist/js/data.min.js` | `htdocs/js/data.min.js` |
| `public/js/main.js` | `dist/js/main.min.js` | `htdocs/js/main.min.js` |
| `public/js/modules.js` | `dist/js/modules.min.js` | `htdocs/js/modules.min.js` |
| `public/js/script.js` | `dist/js/script.min.js` | `htdocs/js/script.min.js` |
| `public/js/error-monitor.js` | `dist/js/error-monitor.js` | `htdocs/js/error-monitor.js` |
| `public/pwa/manifest.json` | `dist/pwa/manifest.json` | `htdocs/pwa/manifest.json` |
| `public/pwa/service-worker.js` | `dist/pwa/service-worker.js` | `htdocs/pwa/service-worker.js` |
| `index.html` | `dist/index.html` | `htdocs/index.html` |

### åç«¯ï¼ˆECSï¼‰

| æ–‡ä»¶ | éƒ¨ç½²ä½ç½® |
|------|----------|
| `server/index.js` | `/var/www/huangshi-genealogy/server/index.js` |
| `server/auth.js` | `/var/www/huangshi-genealogy/server/auth.js` |
| `server/cli-wrapper.js` | `/var/www/huangshi-genealogy/server/cli-wrapper.js` |
| `server/session-store.js` | `/var/www/huangshi-genealogy/server/session-store.js` |
| `server/config/` | `/var/www/huangshi-genealogy/server/config/` |
| `package.json` | `/var/www/huangshi-genealogy/package.json` |

---

## ğŸ“‹ éƒ¨ç½²æµç¨‹

### æ­¥éª¤ 1ï¼šæ„å»ºå‰ç«¯

```bash
# åœ¨é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œ
npm run build
```

### æ­¥éª¤ 2ï¼šä¸Šä¼ å‰ç«¯åˆ°è™šæ‹Ÿä¸»æœº

```bash
# ä½¿ç”¨ FTP æˆ–é˜¿é‡Œäº‘æ§åˆ¶å°
# å°† dist/ ç›®å½•æ‰€æœ‰å†…å®¹ä¸Šä¼ åˆ° htdocs/
```

### æ­¥éª¤ 3ï¼šéƒ¨ç½²åç«¯åˆ° ECS

```bash
# æ–¹å¼ä¸€ï¼šä½¿ç”¨éƒ¨ç½²è„šæœ¬
scp deploy/ecs-deploy.sh root@your-ecs-ip:/tmp/
ssh root@your-ecs-ip "bash /tmp/ecs-deploy.sh"

# æ–¹å¼äºŒï¼šæ‰‹åŠ¨éƒ¨ç½²ï¼ˆå‚è€ƒ é˜¿é‡Œäº‘éƒ¨ç½²æŒ‡å—.mdï¼‰
```

### æ­¥éª¤ 4ï¼šé…ç½®åŸŸå DNS

| åŸŸå | ç±»å‹ | å€¼ |
|------|------|-----|
| `hxfund.cn` | A | è™šæ‹Ÿä¸»æœº IP |
| `www.hxfund.cn` | CNAME | `hxfund.cn` |
| `api.hxfund.cn` | A | ECS å…¬ç½‘ IP |

### æ­¥éª¤ 5ï¼šéªŒè¯éƒ¨ç½²

```bash
# æµ‹è¯•å‰ç«¯
curl https://hxfund.cn/

# æµ‹è¯•åç«¯
curl https://api.hxfund.cn/api/health
```

---

## ğŸ”§ é…ç½®ä¿®æ”¹

### å‰ç«¯ API åœ°å€é…ç½®

åœ¨ `index.html` ä¸­é…ç½®ï¼š

```html
<script>
    window.API_CONFIG = {
        baseURL: 'https://api.hxfund.cn',  // ä¿®æ”¹ä¸ºå®é™… API åœ°å€
        timeout: 30000
    };
</script>
```

### åç«¯ CORS é…ç½®

åœ¨ `server/config/.env` ä¸­é…ç½®ï¼š

```bash
ALLOWED_ORIGINS=https://hxfund.cn,https://www.hxfund.cn
```

---

## ğŸ“Š èµ„æºå¤§å°ç»Ÿè®¡

### å‰ç«¯èµ„æºï¼ˆå‹ç¼©åï¼‰

| ç±»å‹ | å¤§å° |
|------|------|
| HTML | 25.56 KB |
| CSS | 34.65 KB |
| JS | 20.23 KB |
| **æ€»è®¡** | **80.44 KB** |

### åç«¯ä¾èµ–

| ç±»å‹ | å¤§å° |
|------|------|
| node_modules | ~50 MB |
| æºç  | ~100 KB |
| **æ€»è®¡** | **~50 MB** |

---

## âš ï¸ æ³¨æ„äº‹é¡¹

### é˜¿é‡Œäº‘è™šæ‹Ÿä¸»æœº

1. **æµé‡é™åˆ¶**: æ¯æœˆ 1G æµé‡
   - 80KB/é¡µé¢ Ã— 13,000 é¡µé¢ views = 1GB
   - æ³¨æ„ç›‘æ§æµé‡ä½¿ç”¨

2. **å­˜å‚¨é™åˆ¶**: 20GB
   - å‰ç«¯æ–‡ä»¶ä»…çº¦ 100KB
   - å‰©ä½™ç©ºé—´å¯ç”¨äºæ—¥å¿—å’Œå¤‡ä»½

3. **FTP ä¸Šä¼ **:
   - ä½¿ç”¨äºŒè¿›åˆ¶æ¨¡å¼ä¸Šä¼ 
   - ç¡®ä¿æ–‡ä»¶æƒé™æ­£ç¡®

### é˜¿é‡Œäº‘ ECS

1. **å®‰å…¨ç»„é…ç½®**:
   - å¼€æ”¾ 80 ç«¯å£ï¼ˆHTTPï¼‰
   - å¼€æ”¾ 443 ç«¯å£ï¼ˆHTTPSï¼‰
   - å¼€æ”¾ 22 ç«¯å£ï¼ˆSSHï¼‰

2. **æ€§èƒ½ç›‘æ§**:
   - CPU ä½¿ç”¨ç‡ < 80%
   - å†…å­˜ä½¿ç”¨ç‡ < 80%
   - ç£ç›˜ä½¿ç”¨ç‡ < 85%

3. **å¤‡ä»½ç­–ç•¥**:
   - å®šæœŸå¿«ç…§ ECS ç£ç›˜
   - å¤‡ä»½ `server/config/auth.json`

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

- é¡¹ç›®æ–‡æ¡£ï¼š`docs/` ç›®å½•
- éƒ¨ç½²æŒ‡å—ï¼š`deploy/é˜¿é‡Œäº‘éƒ¨ç½²æŒ‡å—.md`
- é—®é¢˜åé¦ˆï¼šGitHub Issues

---

**æ›´æ–°æ—¥æœŸ**: 2026 å¹´ 2 æœˆ 25 æ—¥
**ç‰ˆæœ¬**: v3.3.0
